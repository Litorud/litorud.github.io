<!DOCTYPE html>
<meta charset="UTF-8">
<title>Image Picker</title>
<link rel="stylesheet" type="text/css" href="Style.css"/>
<link rel="icon" type="image/png" href="Icon.png"/>
<meta name="author" content="Itaru"/>
<p id="header">最終更新 : 2011年11月12日 23時20分<object data="Logo.svg" type="image/svg+xml" id="logo"><a href="Top.xhtml">トップページへ</a></object></p>
<h1>Image Picker</h1>
<p>Image Pickerは、リンクされている画像をまとめて表示し、Web上の画像を閲覧する際の手間を軽減するFirefoxの拡張機能です。</p>
<h2>ダウンロード/インストール</h2>
<p><a class="app" href="ImagePicker.xpi" type="application/x-xpinstall">ImagePicker.xpi</a></p>
<dl>
	<dt>バージョン</dt>
	<dd>2.1.2</dd>
	<dt>公開日</dt>
	<dd>2011年8月28日</dd>
	<dt>2.1.1からの変更</dt>
	<dd><ul>
		<li>対応バージョンの上限をなくしました。</li>
	</ul></dd>
	<dt>2.0.2からの変更</dt>
	<dd><ul>
		<li>Firefox 4に対応しました。それ未満のバージョンへの対応は打ち切りました。</li>
		<li>“順番に表示”操作のとき、画像以外の部分をクリックすることでも、次の画像を表示させられるようにしました。</li>
		<li>“ページ内に展開”操作におけるCtrlキーやShiftキーを押したときの挙動について、設定ウィンドウで変更できるようにしました。</li>
		<li>“ページ内に展開”操作において、より多くのサイトで、展開した画像が最前面に描画されるようになりました。</li>
	</ul></dd>
</dl>
<p>ファイルをダウンロードしたら、Firefoxのウィンドウにドロップしてください。</p>
<p>旧版がすでにインストールされている状態でも、上書きインストールで正しくアップデートされます。</p>
<p>インストールが完了したら、ダウンロードしたファイルは削除しても問題ありません。</p>
<h2>できること</h2>
<p>Image Pickerは、表示されているページに対して、以下の4種類の操作を行うことができます。</p>
<dl>
	<dt>ページ内に展開</dt>
	<dd>現在表示されているページからリンクされている画像を、リンクされている位置に直接表示します。</dd>
	<dt>画像のみを取り出す</dt>
	<dd>現在表示されているページからリンクされている画像を、新しいタブにまとめて表示します。Enterキーを押すと、そのタブを閉じます。</dd>
	<dt>順番に表示</dt>
	<dd>現在表示されているページからリンクされている画像のうち、最初の1枚だけを新しいタブで表示します。Enterキーを押すか、画像以外の部分をクリックすると、次の画像が表示されます。すべての画像を表示した後なら、そのタブを閉じます。</dd>
	<dt>すべてのリンクを順番に表示</dt>
	<dd>現在表示されているページからリンクされている資源のうち、最初の資源を新しいタブで読み込みます。Enterキーを押すと次の資源が読み込まれます。すべての資源を読み込んだ後にEnterキーを押すと、そのタブを閉じます。Galleryコンテンツなどで見られる、画像を表示するページへのリンクをまとめたページで使うことを想定しています。</dd>
</dl>
<p>最初は“ページ内に展開”操作が既定の動作に設定されています。これは設定ウィンドウか、[ツール]メニューの[Image Picker]項目で変更することができます。</p>
<h2>操作方法</h2>
<p>Image Pickerをインストールすると、ツールバーにImage Pickerのボタンを配置できるようになり、[ツール]メニューとコンテキストメニューに“Image Picker”という項目が追加されます。</p>
<p class="note">ツールバーにImage Pickerのボタンを配置するには、[表示]→[ツールバー]→[カスタマイズ]と選択し、表示されたツールバーパレットからImage Pickerのボタンをツールバーの好きな位置にドラッグ&amp;ドロップしてください。</p>
<h3>ツールバーのボタンの使い方</h3>
<p>ツールバーのボタンを押した場合は既定の動作に設定されている操作を実行します。ただし、“画像のみを取り出す”、“順番に表示”、もしくは“すべてのリンクを順番に表示”操作によって開かれたタブが表示されている場合は、Enterキーを押したときと同じ処理を行います。</p>
<p>つまり、“画像のみを取り出す”操作によって開かれたタブが表示されている場合は、そのタブを閉じます。また、“順番に表示”/“すべてのリンクを順番に表示”操作によって開かれたタブが表示されている場合は、次の資源を表示します。すべての資源を表示した後なら、そのタブを閉じます。</p>
<p>また、ツールバーのボタンにはドロップダウンメニューが付いており、そこから操作を選んで実行することができます。</p>
<h3>[ツール]メニューの[Image Picker]項目の使い方</h3>
<p>[ツール]メニューの[Image Picker]項目からは、サブメニューで操作を選択して実行することができます。さらに、選択した操作は既定の動作に設定されます。</p>
<h3>コンテキストメニューの[Image Picker]項目の使い方</h3>
<p>コンテキストメニューの[Image Picker]項目は、ツールバーのボタンを押したときと同じ処理を行います。</p>
<p>つまり、通常は既定の動作に設定されている操作を実行します。“画像のみを取り出す”操作によって開かれたタブが表示されている場合は、そのタブを閉じます。また、“順番に表示”/“すべてのリンクを順番に表示”操作によって開かれたタブが表示されている場合は、次の資源を表示します。すべての資源を表示した後なら、そのタブを閉じます。</p>
<hr class="sub"/>
<p>どの操作でも、ページの一部または全部が選択されている場合、<em>選択範囲に含まれるリンクのみが調べる対象</em>になります。どこも選択されていない場合は、ページに含まれるすべてのリンクが調べる対象になります。</p>
<p>Shiftキーを押しながら“ページ内に展開”操作を実行すると、右サイドバーより手前に画像が表示されるという挙動を抑制します。設定ウィンドウで、Shiftキーを押したときと押さなかったときの動作を逆にすることができます。</p>
<p>Ctrlキーを押しながら“ページ内に展開”操作を実行すると、サムネイルと思しき画像の置換を抑制します。設定ウィンドウで、Ctrlキーを押したときと押さなかったときの動作を逆にすることができます。</p>
<p>Shiftキーを押しながら“画像のみを取り出す”/“順番に表示”/“すべてのリンクを順番に表示”操作を実行すると、リンクを、ページの最初からではなく<em>最後から逆順に</em>調べます。新しい画像がページの初めのほうに追加されていくタイプのページで、昔の画像から順に見ていくときに使うことを想定しています。</p>
<p>Ctrlキーを押しながら“画像のみを取り出す”/“順番に表示”/“すべてのリンクを順番に表示”操作を実行すると、新しいタブを開かずに<em>現在のタブをそのまま使います</em>。操作の完了後、そのタブはEnterキー等で閉じられるようになることに注意してください。設定ウィンドウで、Ctrlキーを押したときと押さなかったときの動作を逆にすることができます。</p>
<h2>お願い</h2>
<p><strong>画像へのリンクを大量に含むページで使用する場合、一部を選択してから使用するなどして、一度に大量のリクエストがサーバーに送られることのないように配慮してください。</strong></p>
<h2>設定ウィンドウの項目</h2>
<h3>既定の動作</h3>
<p>ツールバーのボタンを押したときや、コンテキストメニューの[Image Picker]項目で使われる既定の動作を設定できます。</p>
<h3>画像と判定する基準</h3>
<p>リンク先が画像かどうかを調べるときに使われます。href属性に指定されたURIのパス部に、ここに設定された文字列を含む場合、そのリンク先を画像と判断します。複数の文字列を設定するときは‘|’で区切ります。大文字/小文字は区別しません。</p>
<h3>表示</h3>
<p>ツールメニューやコンテキストメニューに項目を表示するかどうかを設定できます。ちなみに、ツールバーのボタンを非表示にするときはツールバーパレットに戻してください。</p>
<h3>詳細設定</h3>
<p>“サムネイル画像を置き換える”のチェックを外すと、“ページ内に展開”操作において、Ctrlキーを押したときと押さなかったときの動作を逆にすることができます。</p>
<p>“右サイドバーより手前に表示する”のチェックを外すと、“ページ内に展開”操作において、Shiftキーを押したときと押さなかったときの動作を逆にすることができます。</p>
<p>“別のタブで開く”のチェックを外すと、“画像のみを取り出す”/“順番に表示”/“すべてのリンクを順番に表示”操作において、Ctrlキーを押したときと押さなかったときの動作を逆にすることができます。</p>
<hr class="sub"/>
<p>初期設定は次のようになっています。</p>
<table summary="Image Pickerの初期設定値">
	<tr><th>項目</th><th>初期設定</th></tr>
	<tr><td>既定の動作</td><td>ページ内に展開</td></tr>
	<tr><td>画像と判定する基準</td><td>.jpg|.png|.gif</td></tr>
	<tr><td>ツールメニューに項目を表示</td><td>On</td></tr>
	<tr><td>コンテキストメニューに項目を表示</td><td>On</td></tr>
	<tr><td>右サイドバーより手前に表示する</td><td>On</td></tr>
	<tr><td>サムネイル画像を置き換える</td><td>On</td></tr>
	<tr><td>別のタブで開く</td><td>On</td></tr>
</table>
<h2>制限事項</h2>
<p>Image Pickerは、href属性に指定されたURIのパス部に、<em>設定された文字列を含む場合に、そのリンク先を画像と判断</em>します。したがって、これらのいずれも含まないものは、実際は画像ファイルだったとしてもImage Pickerの操作が適用されません。また、これらのいずれかを含んでいれば、<em>実際は画像ファイルでなかったとしても</em>Image Pickerの操作が適用されます。</p>
<p>“ページ内に展開”/“別タブに表示”操作は、画像を表示するために、data属性に画像のURIを指定した<em>object要素を使用</em>します。したがって、画像のURIによってはobject要素では解釈されず、画像が表示されないことがあります。ちなみに、一般的には画像の表示にはimg要素が多く使われますが、Firefoxでは、画像の表示にobject要素を使ってもimg要素を使っても同じ結果になります。</p>
<p>“順番に表示”/“すべてのリンクを順番に表示”操作では、保持している資源を順番に表示しますが、<em>保持されるのは1回の実行分だけ</em>です。たとえば、あるページで“順番に表示”操作を実行した後、すべての画像を表示する前に別のタブで“すべてのリンクを順番に表示”操作を実行した場合、最初の実行で保持されていた画像は表示されなくなります。最初の実行で開かれたタブでEnterキーを押すと、新しく開かれたタブに新しく保持された資源が表示されます。</p>
<p>“順番に表示”/“すべてのリンクを順番に表示”操作では、保持している残りの資源の数がタイトルバーに表示されますが、これは<em>まだ表示していない資源の数</em>を示すものです。したがって、戻る操作を行ったときは、後何回画像が表示されるかという数とは食い違うことになります。</p>
<p>フレームを使用しているページで、いずれかのフレームでのみ範囲選択している場合、“ページ内に展開”/“画像のみを取り出す”操作と、“順番に表示”/“すべてのリンクを順番に表示”操作とでは挙動が若干違います。“ページ内に展開”/“別タブに表示”操作の場合は、範囲選択されていないフレームにおいてはそのフレームに含まれるすべてのリンクが調べる対象になりますが、“順番に表示”/“すべてのリンクを順番に表示”操作の場合は1つでも範囲選択されているフレームがあれば、あらゆるフレームにおいて、選択範囲に含まれるリンクのみが調べる対象になります。</p>
<h2>内部的な特別な処理</h2>
<p>“ページ内に展開”/“別タブに表示”/“順番に表示”操作では、現在表示されているページにあるリンクのうち画像へのリンクだけを処理しますが、その際、<em>同じ画像へのリンクが連続したら2回目以降のリンクは処理しません</em>。これによって、同じ画像へのリンクに複数のa要素を使っているページで、Image Pickerが同じ画像を連続して表示することになるのを防ぎます。同様に、“すべてのリンクを順番に表示”操作でも、同じ資源へのリンクが連続したら2回目以降のリンクは処理しません。</p>
<p>“順番に表示”/“すべてのリンクを順番に表示”操作は、次以降に表示する資源を<em>先読み</em>します。この先読みは、サーバーの負荷軽減と効果的なキャッシュ利用のために、キャッシュされている資源の数が4つ以上なら先読みによるダウンロードの合間に2秒間おくようにし、25に達したら次以降の資源のリクエストを一時停止します。また、ユーザーの操作によって、表示される資源がまだキャッシュされていないものに追いついてしまった場合は、先読みを一時停止します。</p>
<p>先読みによってリクエストされるURIが無効なものだった場合は、そのURIは表示されるURIの中から除かれます。</p>
<p>“ページ内に展開”操作では、画像を展開する際、リンクしていた要素に<em>img要素かobject要素が含まれていれば、それを展開する画像の要素で置換</em>します。画像へのリンクに画像が使われている場合、その画像はリンク先の画像のサムネイルであることが多いからです。この挙動は、“操作方法”のセクションに書いたように、設定ウィンドウから停止することができ、また、Ctrlキーを押しながら操作を実行することで設定と逆の動作をさせることができます。</p>
<p>“ページ内に展開”操作を同じページに対して複数回実行しても、画像が<em>何重にも展開されて表示されることはない</em>ようになっています。</p>
<p>“順番に表示”/“すべてのリンクを順番に表示”操作では、次の資源を表示する際に進む操作が可能であれば、<em>代わりに進む操作を実行</em>します。</p>
<p>マルチカラムレイアウトになっているページなどで“ページ内に展開”操作を実行した場合に、展開された画像と他のカラムなどの内容が重なることがあります。このような場合は、<em>展開された画像のほうが上に描画される</em>ようになっています。この挙動は、“操作方法”のセクションに書いたように、設定ウィンドウから停止することができ、また、Shiftキーを押しながら操作を実行することで設定と逆の動作をさせることができます。</p>
<h2>アンインストール</h2>
<p>[ツール]→[アドオン]と選択し、開いたアドオンマネージャから“Image Picker”を選択し、“削除”ボタンを押すとアンインストールできます。</p>
<p>ただし、Firefoxは、初期設定から変更されている値は次に再びインストールしたときのために保持するようです。Image Pickerに関する情報を完全に削除するには、あらかじめImage Pickerの設定をすべて初期値に戻し、ツールバーのボタンをツールバーパレットに戻してからアンインストールします。</p>
<p class="note">ツールバーのボタンをツールバーパレットに戻すのは、ツールバーに配置するボタンの情報がlocalstore.rdfに保持されているからです。</p>
<h2>ライセンス</h2>
<p>この拡張機能を再配布する場合、特に許可を求める必要はありません。この拡張機能を改変して再配布してもかまいません。ただし、いずれの場合も一次配布元としてこのサイトのURIを明記してください。</p>
<hr/>
<dl>
	<dt>初版公開日</dt>
	<dd>2008年2月11日</dd>
</dl>