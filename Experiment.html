<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<title>実験ページ</title>
	<link rel="stylesheet" type="text/css" href="Style.css">
	<link rel="icon" type="image/png" href="Icon.png">
	<link rel="start" href="index.html" title="トップページ">
	<meta name="author" content="Itaru">
	<script type="application/ecmascript" src="Script.js" async></script>
</head>

<body>
	<header>
		<object data="Logo.svg" type="image/svg+xml"><a href="index.html">トップページへ</a></object>
		<dl>
			<dt>最終更新</dt>
			<dd>2019年2月10日 5時38分</dd>
		</dl>
	</header>
	<h1>実験ページ</h1>
	<form action="Experiment.html" onsubmit="childNodes[5].textContent=normalizeJapanese(text1.value);return false">
		<p>全角の英数字記号を半角に変換したり、半角のカタカナを全角に変換したり、カタカナや捨て仮名を捨て仮名でないひらがなに変換したりします。</p>
		<p><input type="text" name="text1" placeholder="変換したい文を入力してください。" tabindex="1"><button tabindex="2">変換</button>
		</p>
		<p>ここに変換した文が表示されます。</p>
	</form>
	<form action="#" onsubmit="return false">
		<textarea id="a" rows=10 cols=50 placeholder="ここに入力された文字数を表示します。" onchange="count(this)"
			onkeypress="count(this)" onclick="count(this)"></textarea><button type=reset
			onclick="dd1.textContent=dd2.textContent=0">消去</button>
		<dl>
			<dt>文字数</dt>
			<dd id="num1">0</dd>
			<dt>改行文字を除いた文字数</dt>
			<dd id="num2">0</dd>
		</dl>
	</form>
	<form action="#" onsubmit="print(this);return false">
		<p>
			<input type="text" name="text1" placeholder="入力してください。" onfocus="value=''" tabindex="3">
			<button tabindex="4">書き出す</button>
		</p>
		<p>ここが変化します。</p>
	</form>
	<p>
		<object data="StageTitle.svg" type="image/svg+xml" width="382" height="448"><a
				href="StageTitle.svg">アニメーションするSVG</a></object>
		2度クリックすると止まります。
	</p>
	<form action="#" onsubmit="getCode(this);return false">
		<p>
			<select name="select" tabindex="5">
				<option selected="selected">index.html
				<option>Style.css
				<option>Script.js
				<option>Logo.svg
				<option>Experiment.html
				<option>StageTitle.svg
				<option>TURB1.svg
			</select>
			<button tabindex="6">読み込む</button>
		</p>
		<pre>ここにコードが表示されます。</pre>
	</form>
	<p class="draggable">ドラッグできます。
		<ol class="draggable">
			<li>色は匂えど散りぬるを
			<li>我が世誰ぞ常ならん
			<li>有為の奥山今日越えて
			<li>浅き夢見じ酔いもせず
			<li><strong>ん</strong>
		</ol>
	</p>
	<p>
		<a href="http://bio100.jp/">Bio_100%</a>の<a
			href="http://www.vector.co.jp/soft/dos/game/se003374.html">TURB第1話</a>において、旅の楽団Ⅱに話しかける順番です。
		<object data="TURB1.svg" type="image/svg+xml" width="688" height="608"><a href="TURB1.svg">順番を示すSVG</a></object>
	</p>
	<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 110 110" id="star">
		<style>
			line {
				stroke: black
			}
		</style>
		<circle r="2" cx="55" cy="55" />
		<circle r="2" cx="55" cy="55" />
		<circle r="2" cx="55" cy="55" />
		<circle r="2" cx="55" cy="55" />
		<circle r="2" cx="55" cy="55" />
		<line x1="0" y1="0" x2="0" y2="0" />
		<line x1="0" y1="0" x2="0" y2="0" />
		<line x1="0" y1="0" x2="0" y2="0" />
		<line x1="0" y1="0" x2="0" y2="0" />
		<line x1="0" y1="0" x2="0" y2="0" />
		<script>
			(function () {
				var svgElem = document.getElementById("star"), nodes = svgElem.childNodes,
					c1x = nodes[3].cx.baseVal, c1y = nodes[3].cy.baseVal,
					c2x = nodes[5].cx.baseVal, c2y = nodes[5].cy.baseVal,
					c3x = nodes[7].cx.baseVal, c3y = nodes[7].cy.baseVal,
					c4x = nodes[9].cx.baseVal, c4y = nodes[9].cy.baseVal,
					c5x = nodes[11].cx.baseVal, c5y = nodes[11].cy.baseVal,
					theta = -Math.PI / 2, d = 2 * Math.PI / 5,
					c1xd = Math.cos(theta) * 50, c1yd = Math.sin(theta) * 50,
					c2xd = Math.cos(theta += d) * 50, c2yd = Math.sin(theta) * 50,
					c3xd = Math.cos(theta += d) * 50, c3yd = Math.sin(theta) * 50,
					c4xd = Math.cos(theta += d) * 50, c4yd = Math.sin(theta) * 50,
					c5xd = Math.cos(theta += d) * 50, c5yd = Math.sin(theta) * 50,
					count = 0,
					l1 = nodes[13], l2 = nodes[15], l3 = nodes[17], l4 = nodes[19], l5 = nodes[21],
					l = l1, index = 13,
					animate = moveCircle,
					timer = setInterval(function () {
						animate();
					}, 20);
				function moveCircle() {
					d = Math.sin(count * Math.PI / 2);
					c1x.value = 55 + c1xd * d;
					c2x.value = 55 + c2xd * d;
					c3x.value = 55 + c3xd * d;
					c4x.value = 55 + c4xd * d;
					c5x.value = 55 + c5xd * d;
					c1y.value = 55 + c1yd * d;
					c2y.value = 55 + c2yd * d;
					c3y.value = 55 + c3yd * d;
					c4y.value = 55 + c4yd * d;
					c5y.value = 55 + c5yd * d;
					if ((count += 0.02) >= 1) {
						l1.xspeed = (c3x.value - (l1.x2.baseVal.value = l1.x1.baseVal.value = c1x.value)) / 10;
						l2.xspeed = (c5x.value - (l2.x2.baseVal.value = l2.x1.baseVal.value = c3x.value)) / 10;
						l3.xspeed = (c2x.value - (l3.x2.baseVal.value = l3.x1.baseVal.value = c5x.value)) / 10;
						l4.xspeed = (c4x.value - (l4.x2.baseVal.value = l4.x1.baseVal.value = c2x.value)) / 10;
						l5.xspeed = (c1x.value - (l5.x2.baseVal.value = l5.x1.baseVal.value = c4x.value)) / 10;
						l1.yspeed = (c3y.value - (l1.y2.baseVal.value = l1.y1.baseVal.value = c1y.value)) / 10;
						l2.yspeed = (c5y.value - (l2.y2.baseVal.value = l2.y1.baseVal.value = c3y.value)) / 10;
						l3.yspeed = (c2y.value - (l3.y2.baseVal.value = l3.y1.baseVal.value = c5y.value)) / 10;
						l4.yspeed = (c4y.value - (l4.y2.baseVal.value = l4.y1.baseVal.value = c2y.value)) / 10;
						l5.yspeed = (c1y.value - (l5.y2.baseVal.value = l5.y1.baseVal.value = c4y.value)) / 10;
						count = 0;
						animate = drawLine;
					}
				}
				function drawLine() {
					l.x2.baseVal.value += l.xspeed;
					l.y2.baseVal.value += l.yspeed;
					if (++count >= 10) {
						if (index < 20) {
							l = nodes[index += 2];
							count = 0;
						} else {
							clearInterval(timer);
							addEventListener("click", restart, false);
						}
					}
				}
				function restart() {
					removeEventListener("click", restart, false);
					count = 1;
					animate = clear;
					timer = setInterval(function () {
						animate();
					}, 20);
				}
				function clear() {
					if (count <= 0) {
						c1x.value = c1y.value = c2x.value = c2y.value = c3x.value = c3y.value = c4x.value = c4y.value = c5x.value = c5y.value = 55;
						(l = l1).x1.baseVal.value = l2.x1.baseVal.value = l3.x1.baseVal.value = l4.x1.baseVal.value = l5.x1.baseVal.value = l1.y1.baseVal.value = l2.y1.baseVal.value = l3.y1.baseVal.value = l4.y1.baseVal.value = l5.y1.baseVal.value = l1.x2.baseVal.value = l2.x2.baseVal.value = l3.x2.baseVal.value = l4.x2.baseVal.value = l5.x2.baseVal.value = l1.y2.baseVal.value = l2.y2.baseVal.value = l3.y2.baseVal.value = l4.y2.baseVal.value = l5.y2.baseVal.value = count = 0;
						index = 13;
						animate = moveCircle;
						svgElem.setAttribute("opacity", 1);
					} else {
						svgElem.setAttribute("opacity", count -= 0.05);
					}
				}
			})();
		</script>
	</svg>
	<form action="#" onsubmit="read(this);return false">
		<p><input type="file" name="file1"><button>インポート</button></p>
		<textarea rows=10 cols=50 name="textarea1">UTF-8のテキストファイルを指定してください。</textarea>
		<p><button type="button" onclick="write(this)">エクスポート</button></p>
	</form>
	<blockquote class="twitter-tweet" data-lang="ja">
		<p lang="ja" dir="ltr">先日「アメガエリの滝」に行った。水は綺麗で滝は迫力があり、とても素敵な所だった。 <a
				href="https://t.co/VZNdAfpv9a">pic.twitter.com/VZNdAfpv9a</a></p>&mdash;
		Itaru (@Litorud) <a
			href="https://twitter.com/Litorud/status/1052942297774481408?ref_src=twsrc%5Etfw">2018年10月18日</a>
	</blockquote>
	<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
	<section>
		<h2>基数変換</h2>
		<dl>
			<dt>2進数</dt>
			<dd><input id="text2" tabindex="7"></dd>
			<dt>10進数</dt>
			<dd><input id="text10" type="number" tabindex="8"></dd>
			<dt>36進数</dt>
			<dd><input id="text36" tabindex="9"></dd>
			<dt>64進数</dt>
			<dd><input id="text64" tabindex="10">※負数には対応しません。‘-（ハイフンマイナス）’は10進数における63を表します。</dd>
		</dl>
		<script defer>
			addEventListener("DOMContentLoaded", function () {
				const chars = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";
				const text2 = document.getElementById("text2");
				const text10 = document.getElementById("text10");
				const text36 = document.getElementById("text36");
				const text64 = document.getElementById("text64");

				text2.addEventListener("input", function () {
					const i = parseInt(text2.value, 2);

					text10.value = to10(i);
					text36.value = to36(i);
					text64.value = to64(i);
				});

				text10.addEventListener("input", function () {
					const i = parseInt(text10.value);

					text2.value = to2(i);
					text36.value = to36(i);
					text64.value = to64(i);
				});

				text36.addEventListener("input", function () {
					const i = parseInt(text36.value, 36);

					text2.value = to2(i);
					text10.value = to10(i);
					text64.value = to64(i);
				});

				text64.addEventListener("input", function () {
					const i = from64(text64.value);

					text2.value = to2(i);
					text10.value = to10(i);
					text36.value = to36(i);
				});

				function from64(text) {
					const is = Array.from(text)
						.map(c => chars.indexOf(c))
						.reverse();

					let result = 0;
					let power = 1;
					for (let i of is) {
						result += i * power;
						power *= 64;
					}

					return result;
				}

				function to2(i) {
					return i.toString(2);
				}

				function to10(i) {
					return i.toString();
				}

				function to36(i) {
					return i.toString(36);
				}

				function to64(i) {
					if (isNaN(i)) {
						return "NaN";
					} else if (i < 0) {
						return "Underflow"
					}

					const bitsIterator = getBitsIterator(i);
					return Array.from(bitsIterator)
						.map(b => chars[b])
						.reverse()
						.join("");
				}

				function* getBitsIterator(number) {
					do {
						yield number % 64;
						number = Math.floor(number / 64);
					} while (number > 0);
				}
			});
		</script>
	</section>
</body>

</html>